import React, { useState } from 'react';
import { Form } from 'react-bootstrap';
import { useTranslation } from 'react-i18next';

const Categories = ({ postData, handleChangeInput }) => {
  const { t, i18n } = useTranslation('categories');
  const isRTL = i18n.language === 'ar';
  const [searchTerm, setSearchTerm] = useState('');

  // Mapeo de categorÃ­as a emojis (solo emojis Unicode)
  const categoryEmojis = {
    'immobilier': 'ðŸ ',
    'vehicules': 'ðŸš—',
    'telephones': 'ðŸ“±',
    'informatique': 'ðŸ’»',
    'electromenager': 'ðŸ”Œ',
    'piecesDetachees': 'âš™ï¸',
    'vetements': 'ðŸ‘•',
    'alimentaires': 'ðŸŽ',
    'santebeaute': 'ðŸ’„',
    'meubles': 'ðŸ›‹ï¸',
    'services': 'ðŸ› ï¸',
    'materiaux': 'ðŸ§±',
    'loisirs': 'ðŸŽ®',
    'emploi': 'ðŸ’¼',
    'sport': 'âš½',
    'voyages': 'âœˆï¸'
  };

  // Mapeo de colores para usar en otro lugar si es necesario
  const categoryColors = {
    'immobilier': '#8b5cf6',
    'vehicules': '#dc2626',
    'telephones': '#3b82f6',
    'informatique': '#1f2937',
    'electromenager': '#f59e0b',
    'piecesDetachees': '#6b7280',
    'vetements': '#ec4899',
    'alimentaires': '#10b981',
    'santebeaute': '#ef4444',
    'meubles': '#92400e',
    'services': '#f59e0b',
    'materiaux': '#7c3aed',
    'loisirs': '#3b82f6',
    'emploi': '#1e40af',
    'sport': '#10b981',
    'voyages': '#0ea5e9'
  };

  // Datos de las categorÃ­as
  const categories = [
    { id: 'immobilier', name: t('immobilier', 'Immobilier') },
    { id: 'vehicules', name: t('automobiles') }, 
    { id: 'telephones', name: t('telephones', 'TÃ©lÃ©phones & Accessoires') },
    { id: 'informatique', name: t('informatique', 'Informatique') },
    { id: 'electromenager', name: t('electromenager', 'Ã‰lectromÃ©nager & Ã‰lectronique') },
    { id: 'piecesDetachees', name: t('piecesDetachees', 'Pieces Detachees') },
    { id: 'vetements', name: t('vetements', 'VÃªtements & Mode') },
    { id: 'alimentaires', name: t('Alimentaires', 'Alimentaires') },
    { id: 'santebeaute', name: t('sante_beaute', 'SantÃ© & BeautÃ©') },
    { id: 'meubles', name: t('meubles', 'Meubles & Maison') },
    { id: 'services', name: t('Services', 'Services') },
    { id: 'materiaux', name: t('Materiaux', 'Materiaux') },
    { id: 'loisirs', name: t('loisirs', 'Loisirs & Divertissements') },
    { id: 'emploi', name: t('emploi', "Offres & Demandes d'emploi") },
    { id: 'sport', name: t('Sport', 'Sport') },
    { id: 'voyages', name: t('Voyage', 'Voyages') }
  ];

  const filteredCategories = categories.filter(category =>
    category.name.toLowerCase().includes(searchTerm.toLowerCase())
  );

  return (
    <div className={`${isRTL ? 'rtl' : 'ltr'}`}>
      <Form.Group>
       
        <Form.Select
          name="categorie"
          value={postData.categorie || ''}
          onChange={handleChangeInput}
          className={`form-select ${isRTL ? 'text-end' : ''}`}
          required
          dir={isRTL ? 'rtl' : 'ltr'}
        >
          <option value="">{t('select_category', 'Choisissez une catÃ©gorie')}</option>
          {filteredCategories.map((category) => {
            const emoji = categoryEmojis[category.id] || '';
            const color = categoryColors[category.id];
            
            // SOLUCIÃ“N: Concatenar emoji + texto como string simple
            const optionText = `${emoji} ${category.name}`;
            
            return (
              <option 
                key={category.id} 
                value={category.id}
                // Opcional: puedes agregar un style, pero algunos navegadores lo ignoran
                style={{ color: color }}
              >
                {optionText}
              </option>
            );
          })}
        </Form.Select>
      </Form.Group>
 

      <style>
        {`
          .rtl { direction: rtl; text-align: right; }
          .ltr { direction: ltr; text-align: left; }
          .form-select {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            border: 1px solid #ced4da;
          }
          .form-select:focus {
            border-color: #86b7fe;
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
          }
        `}
      </style>
    </div>
  );
};

export default React.memo(Categories);